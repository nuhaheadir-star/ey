<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Log - PowerPort Digital Twin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #2a3a7c);
            color: #fff;
            min-height: 100vh;
            padding: 15px;
        }

        .dashboard-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .page-title {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(to right, #4cd964, #5ac8fa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .filters {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
        }

        .filter-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .filter-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85rem;
        }

        .filter-btn.active {
            background: #5ac8fa;
        }

        .search-box {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 20px;
            width: 100%;
            max-width: 300px;
            margin: 0 auto;
        }

        .search-box input {
            background: transparent;
            border: none;
            color: white;
            margin-left: 10px;
            outline: none;
            width: 100%;
            font-size: 0.9rem;
        }

        .search-box input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .event-log {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
            max-height: 500px;
            overflow-y: auto;
        }

        .event-item {
            display: flex;
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: background 0.3s;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .event-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .event-item:last-child {
            border-bottom: none;
        }

        .event-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .event-content {
            flex: 1;
        }

        .event-header {
            display: flex;
            flex-direction: column;
            margin-bottom: 8px;
        }

        .event-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .event-time {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.8rem;
        }

        .event-description {
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }

        .event-details {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .event-tag {
            background: rgba(255, 255, 255, 0.1);
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
        }

        .event-tag i {
            margin-right: 5px;
            font-size: 0.7rem;
        }

        .power {
            background: rgba(90, 200, 250, 0.2);
            color: #5ac8fa;
        }

        .mode {
            background: rgba(76, 217, 100, 0.2);
            color: #4cd964;
        }

        .alert {
            background: rgba(255, 59, 48, 0.2);
            color: #ff3b30;
        }

        .warning {
            background: rgba(255, 149, 0, 0.2);
            color: #ff9500;
        }

        .info {
            background: rgba(90, 200, 250, 0.2);
            color: #5ac8fa;
        }

        .fault {
            background: rgba(255, 204, 0, 0.2);
            color: #ffcc00;
        }

        .icon-power {
            background: rgba(90, 200, 250, 0.3);
            color: #5ac8fa;
        }

        .icon-mode {
            background: rgba(76, 217, 100, 0.3);
            color: #4cd964;
        }

        .icon-alert {
            background: rgba(255, 59, 48, 0.3);
            color: #ff3b30;
        }

        .icon-warning {
            background: rgba(255, 149, 0, 0.3);
            color: #ff9500;
        }

        .icon-info {
            background: rgba(90, 200, 250, 0.3);
            color: #5ac8fa;
        }

        .icon-fault {
            background: rgba(255, 204, 0, 0.3);
            color: #ffcc00;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            padding: 15px;
            font-size: 0.8rem;
            opacity: 0.7;
        }

        .new-event-indicator {
            position: fixed;
            top: 15px;
            right: 15px;
            background: #4cd964;
            color: white;
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            z-index: 100;
            display: none;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Mobile-specific optimizations */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .page-title {
                font-size: 1.5rem;
                margin-bottom: 15px;
            }
            
            .filters {
                padding: 12px;
            }
            
            .filter-group {
                gap: 8px;
            }
            
            .filter-btn {
                padding: 5px 10px;
                font-size: 0.8rem;
            }
            
            .event-log {
                padding: 15px;
                max-height: 400px;
            }
            
            .event-item {
                padding: 12px;
                flex-direction: column;
            }
            
            .event-icon {
                margin-bottom: 10px;
                margin-right: 0;
                align-self: flex-start;
            }
            
            .event-header {
                flex-direction: row;
                justify-content: space-between;
                align-items: flex-start;
            }
            
            .event-title {
                font-size: 0.95rem;
                margin-bottom: 0;
            }
            
            .event-time {
                font-size: 0.75rem;
                text-align: right;
            }
            
            .event-description {
                font-size: 0.85rem;
            }
            
            .event-details {
                gap: 8px;
            }
            
            .event-tag {
                padding: 3px 8px;
                font-size: 0.7rem;
            }
        }

        @media (max-width: 480px) {
            .filter-group {
                flex-direction: column;
                align-items: center;
            }
            
            .filter-btn {
                width: 100%;
                max-width: 200px;
            }
            
            .event-header {
                flex-direction: column;
            }
            
            .event-time {
                text-align: left;
                margin-top: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <h1 class="page-title">System Event Log</h1>

        <div class="filters">
            <div class="filter-group">
                <button class="filter-btn active" data-filter="all">All Events</button>
                <button class="filter-btn" data-filter="alert">Alerts</button>
                <button class="filter-btn" data-filter="power">Power Events</button>
                <button class="filter-btn" data-filter="mode">System Changes</button>
                <button class="filter-btn" data-filter="fault">Faults</button>
            </div>
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Search events...">
            </div>
        </div>

        <div class="event-log" id="eventLog">
            <!-- Events will be dynamically added here -->
        </div>

        <div class="footer">
            <p>PowerPort Digital Twin Event Log • Real-time System Monitoring</p>
        </div>
    </div>

    <div class="new-event-indicator" id="newEventIndicator">New Event Added!</div>

    <script>
        // Event data templates
        const eventTemplates = [
            {
                type: 'power',
                title: 'Power Update',
                description: 'Buoy B1 output increased to {value}%',
                icon: 'fas fa-bolt',
                tags: [
                    { class: 'power', icon: 'fas fa-arrow-up', text: 'Power Increase' },
                    { class: '', icon: 'fas fa-buoy', text: 'Buoy B1' }
                ],
                valueRange: { min: 60, max: 85 }
            },
            {
                type: 'mode',
                title: 'Mode Change',
                description: 'Buoy switched to {mode} (wave {value}%)',
                icon: 'fas fa-cogs',
                tags: [
                    { class: 'mode', icon: 'fas fa-exchange-alt', text: 'Mode Change' },
                    { class: '', icon: 'fas fa-battery-three-quarters', text: 'Charging' }
                ],
                modes: ['Charging Mode', 'Generation Mode', 'Standby Mode', 'Maintenance Mode'],
                valueRange: { min: 70, max: 90 }
            },
            {
                type: 'alert',
                title: 'Temperature Alert',
                description: 'Temperature rising to {value}%, monitoring activated',
                icon: 'fas fa-temperature-high',
                tags: [
                    { class: 'alert', icon: 'fas fa-exclamation-circle', text: 'Temperature Alert' },
                    { class: '', icon: 'fas fa-thermometer-full', text: '{value}°C' }
                ],
                valueRange: { min: 65, max: 80 }
            },
            {
                type: 'warning',
                title: 'Low RPM',
                description: 'Blade RPM dropped to {value}%, waves weakening',
                icon: 'fas fa-tachometer-alt',
                tags: [
                    { class: 'warning', icon: 'fas fa-tachometer-alt', text: 'RPM Warning' },
                    { class: '', icon: 'fas fa-water', text: 'Wave Activity Low' }
                ],
                valueRange: { min: 35, max: 50 }
            },
            {
                type: 'info',
                title: 'Health Check',
                description: 'All systems stable and operating within normal parameters',
                icon: 'fas fa-heartbeat',
                tags: [
                    { class: 'info', icon: 'fas fa-check-circle', text: 'System Healthy' },
                    { class: '', icon: 'fas fa-shield-alt', text: 'All Systems Normal' }
                ]
            },
            {
                type: 'fault',
                title: 'Fault Code {code}',
                description: '{description}',
                icon: 'fas fa-exclamation-triangle',
                tags: [
                    { class: 'fault', icon: 'fas fa-code', text: 'Fault {code}' },
                    { class: '', icon: 'fas fa-cog', text: 'Turbine Assembly' },
                    { class: '', icon: 'fas fa-info-circle', text: 'Minor Issue' }
                ],
                faultCodes: [
                    { code: '102', description: 'Minor vibration detected in turbine assembly' },
                    { code: '105', description: 'Voltage fluctuation in power converter' },
                    { code: '108', description: 'Communication delay with buoy sensors' },
                    { code: '112', description: 'Cooling system operating at reduced capacity' }
                ]
            },
            {
                type: 'power',
                title: 'Grid Connection',
                description: 'Grid synchronization {status} at {value}% capacity',
                icon: 'fas fa-plug',
                tags: [
                    { class: 'power', icon: 'fas fa-bolt', text: 'Grid Connection' },
                    { class: '', icon: 'fas fa-exchange-alt', text: 'Synchronized' }
                ],
                statuses: ['established', 'lost', 'restored', 'optimized'],
                valueRange: { min: 85, max: 100 }
            },
            {
                type: 'info',
                title: 'Data Sync',
                description: 'Real-time data synchronization {status} with cloud servers',
                icon: 'fas fa-cloud',
                tags: [
                    { class: 'info', icon: 'fas fa-sync', text: 'Data Sync' },
                    { class: '', icon: 'fas fa-server', text: 'Cloud Servers' }
                ],
                statuses: ['completed', 'in progress', 'delayed', 'optimized']
            }
        ];

        // Initialize event counters
        let eventCounters = {
            total: 0,
            alerts: 0,
            power: 0,
            mode: 0,
            fault: 0,
            warning: 0,
            info: 0
        };

        // Function to format time for events
        function formatEventTime(date) {
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            
            if (diffMins < 1) {
                return 'Just now';
            } else if (diffMins < 60) {
                return `${diffMins} minute${diffMins > 1 ? 's' : ''} ago`;
            } else if (diffHours < 24) {
                return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
            } else {
                return date.toLocaleDateString('en-US', { 
                    month: 'short', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }
        }

        // Function to generate a random event
        function generateRandomEvent() {
            const template = eventTemplates[Math.floor(Math.random() * eventTemplates.length)];
            let description = template.description;
            let title = template.title;
            let tags = JSON.parse(JSON.stringify(template.tags)); // Deep copy tags
            
            // Replace placeholders with random values
            if (template.valueRange) {
                const value = Math.floor(Math.random() * (template.valueRange.max - template.valueRange.min + 1)) + template.valueRange.min;
                description = description.replace('{value}', value);
                
                // Update tags with values if needed
                tags.forEach(tag => {
                    tag.text = tag.text.replace('{value}', value);
                });
            }
            
            if (template.modes) {
                const mode = template.modes[Math.floor(Math.random() * template.modes.length)];
                description = description.replace('{mode}', mode);
            }
            
            if (template.statuses) {
                const status = template.statuses[Math.floor(Math.random() * template.statuses.length)];
                description = description.replace('{status}', status);
            }
            
            if (template.faultCodes) {
                const fault = template.faultCodes[Math.floor(Math.random() * template.faultCodes.length)];
                title = title.replace('{code}', fault.code);
                description = description.replace('{description}', fault.description);
                
                // Update tags with fault code
                tags.forEach(tag => {
                    tag.text = tag.text.replace('{code}', fault.code);
                });
            }
            
            return {
                type: template.type,
                title: title,
                description: description,
                icon: template.icon,
                tags: tags,
                timestamp: new Date()
            };
        }

        // Function to create an event element
        function createEventElement(event) {
            const eventItem = document.createElement('div');
            eventItem.className = 'event-item';
            eventItem.setAttribute('data-type', event.type);
            
            eventItem.innerHTML = `
                <div class="event-icon icon-${event.type}">
                    <i class="${event.icon}"></i>
                </div>
                <div class="event-content">
                    <div class="event-header">
                        <div class="event-title">${event.title}</div>
                        <div class="event-time">${formatEventTime(event.timestamp)}</div>
                    </div>
                    <div class="event-description">
                        ${event.description}
                    </div>
                    <div class="event-details">
                        ${event.tags.map(tag => `
                            <div class="event-tag ${tag.class}">
                                <i class="${tag.icon}"></i> ${tag.text}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            return eventItem;
        }

        // Function to add a new event to the log
        function addNewEvent() {
            const event = generateRandomEvent();
            const eventElement = createEventElement(event);
            const eventLog = document.getElementById('eventLog');
            
            // Add to the top of the log
            eventLog.insertBefore(eventElement, eventLog.firstChild);
            
            // Update counters
            eventCounters.total++;
            eventCounters[event.type]++;
            
            // Show new event indicator
            showNewEventIndicator();
            
            // Apply current filter
            applyFilter(currentFilter);
        }

        // Function to show new event indicator
        function showNewEventIndicator() {
            const indicator = document.getElementById('newEventIndicator');
            indicator.style.display = 'block';
            
            setTimeout(() => {
                indicator.style.display = 'none';
            }, 3000);
        }

        // Filter functionality
        let currentFilter = 'all';
        
        function applyFilter(filter) {
            currentFilter = filter;
            const eventItems = document.querySelectorAll('.event-item');
            
            eventItems.forEach(item => {
                if (filter === 'all' || item.getAttribute('data-type') === filter) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
            
            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.getAttribute('data-filter') === filter) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }

        // Initialize the event log with some events
        function initializeEventLog() {
            const eventLog = document.getElementById('eventLog');
            
            // Add initial events
            for (let i = 0; i < 8; i++) {
                const event = generateRandomEvent();
                // Set timestamp to be in the past
                event.timestamp = new Date(Date.now() - Math.random() * 24 * 60 * 60 * 1000);
                const eventElement = createEventElement(event);
                eventLog.appendChild(eventElement);
                
                // Update counters
                eventCounters.total++;
                eventCounters[event.type]++;
            }
        }

        // Search functionality
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const eventItems = document.querySelectorAll('.event-item');
                
                eventItems.forEach(item => {
                    const title = item.querySelector('.event-title').textContent.toLowerCase();
                    const description = item.querySelector('.event-description').textContent.toLowerCase();
                    
                    if (title.includes(searchTerm) || description.includes(searchTerm)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        }

        // Set up filter buttons
        function setupFilters() {
            const filterButtons = document.querySelectorAll('.filter-btn');
            
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const filter = this.getAttribute('data-filter');
                    applyFilter(filter);
                });
            });
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            initializeEventLog();
            setupFilters();
            setupSearch();
            
            // Add new event every 10-20 seconds
            setInterval(addNewEvent, 10000 + Math.random() * 10000);
            
            // Update event times every minute
            setInterval(updateEventTimes, 60000);
        });

        // Function to update event times
        function updateEventTimes() {
            const eventTimes = document.querySelectorAll('.event-time');
            eventTimes.forEach(timeElement => {
                // This would need to store the original timestamp to work properly
                // For simplicity, we'll just update relative times
                const eventItem = timeElement.closest('.event-item');
                if (eventItem) {
                    // In a real implementation, we would store the original timestamp
                    // and recalculate the relative time
                    const randomMinutes = Math.floor(Math.random() * 5);
                    timeElement.textContent = `${randomMinutes} minute${randomMinutes !== 1 ? 's' : ''} ago`;
                }
            });
        }
    </script>
</body>
</html>
